### 11_13

Repository랑 interface 계층살펴보기


TCP와 UDP의 차이를 설명해주세요
TCP는 연결형 서비스로 3-way handshaking과정을 통해 연결을 설정하기 때문에 높은 신뢰성을
보장하지만 속도가 비교저거 느리다는 단점이 있다. 
UDP는 비연결형 서비스로 3-way handshaking을 사용하지 않기 떄문에 신뢰성이 떨어지는
단점이 있지만, 데이터 수신 여부를 확인하지 않기 떄문에 속도가 빠르다는 장점이 있다. 

TCP는 신뢰성이 중요한 파일 교환과 같은 경우에 쓰이고 UDP는 실시간성이 중요한
스트리밍에 자주 사용된다. 

TCP 가상 회선 방식 UDP 데이터그램 방식
전송순서 UDP는 전송 순서가 바뀔 수 있지만 TCP는 전송 순서를 보장한다. 
통신 방식은 TCP는 1:1통신, 1:1 OR N:N 통신

물리 계층 데이터 계층, 네트어크 층, 전송 , 세션, 발표 어플리케이션

TCP와 UDP는 7계층 중 TCP/IP의 전송 계층에서 사용되는 프로토콜이다. 

전송 계층은 송신자와 수신자를 연결하는 통신 서비스를 제공하느 ㄴ게층이다. 
데이터의 전달을 담당하며 전달되는 패킷의 오류를 검사하고 재전송 요구 등의 제어를 
담당한다. 

TCP는 연결 지향적 프로토콜이다. 

SYN - 싱크로나이즈 시퀸스 넘버스 - 연결 확인을 보내는 무작위의 숫자 값
ACK - CLient 혹은 Server로부터 받은 SYN에 1을 더해 SYN을 잘 받았다는 ACK

먼저 Open 한 클라이언트가 SYN을 보내고 SYN_SENT상태로 대기한다. 
서버는 SYN-RECEIVED상태로 바꾸고 SYN과 응답 ACKㅡㄹ 보낸다. 

closed 연결 수립을 시작하기 전의 기본 상태
listen 포트가 열린 상태로 연결 요청 대기 중
SYN-sent 

TCP 연결형 서비스 
UDP 비연결형 서비스 

3 way-handshake와 4 way-handshake를 설명해주세요

쓰레웨이는 TCP 네트워크에서 통신 장치가 서로 연결이 잘 되었는지 확인하는 방법
포웨이은 TCP 네트워크에서 통신 하는 장치의 연결을 해제하는 방법이다. 

OSI 7계층에 대해 아는대로 설명해주세요

1계층 물리계층 : 데이터를 전기 신호로 바꿔주는 계층 단위 bit 장비 케이블 리피터 허브
2계층 데이터링크 계층 : 데이터의 물리적인 전송과 에러 검출, 흐름 제어를 담당하는 계층
단위(frame) ex: 이더넷
3계층 네트워크 계층 : 패킷을 목적지까지 가장 빠른 길로 전송하기 위한 계층
단위 packet ex 라우터

4계층 전송 계층 : 최송 수신 프로세스로 데이터의 전송을 담당하는 계층 
단위 세그먼트 ex tcp, udp

5계층 세션 계층 : 컴퓨터끼리 통신을 하귀 위해 세션을 만드는 계층

6계층 표현 계층 : 데이터의 형식 format을 정의하는 계층 코드간의 번역을 담당

7계층 응용 계층 : 사용자에게 통신을 위한 서비스 제공. 인터페이스 역할


HTTP MEthod와 각각의 사용되는 경우에 대해서 설명해주세요
GET 데이터조회
POST 요청 데이터 처리 (보통 데이터 등록 사용)
PUT 데이터 변경 (해당 데이터가 없으면 생성)
PATCH 일부 데이터만 변경
DELETE 데이터 삭제

GET과 POST의 차이에 대해 설명해주세요
GET은 데이터를 조회하기 위해 사용되는 방식으로 데이터를 헤더에 추가하여 전송하느 ㄴ방식이다. 
URL에 데이터가 노출되므로 보안적으로 중요한 데이터를 포함해서느 ㄴ안된다. 

POST느 데이터를 추가 또는 수정하기 위해 사용되는 방식으로 데이터를 바디에 
추가하여 전송하는 방식이다. 
완전히 안전하다는 것은 아니지만 URL에 데이터가 노출되지 않아 GET보다는 안전하다. 

세션 기반 인증과 토큰 기반 인증의 차이에 대해 알려주세요
세션기반인증은 클라이언트로부터 요청을 받으면 클라이언트의 상태 정보를 저장하므로 
stateful한 구조를 가지고, 

토큰기반 인증은 상태정보를 서버에 저장하지 않으므로 Stateless한 구조를 가집니다. 


서버에 세션을 저장하기 떄문에 사용자가 증가하며 서버에 과부하를 줄 수 있어 
확장성이 낮다

해커가 훔친 쿠키를 이용해 요청을 보내면 서버는 올바른 사용자가 보낸 요청인지 알수 없다. 
세션 하이재킹 공격

그렇다면 세션 기반 인증과 토큰 기반 인증은 각각 어느 경우에 적합한가요?

단일 도메인이라면 세션 기반 인증을 사용하고, 아니라면 토큰 기반 인증을 사용하는것이
적합하다고 생각
왜냐하면 세션을 관리할 때 사용되는 쿠키는 단일 도메인 및 서브 도메인에서만 작동하도록
설계되어있기 떄문에 여러 도메인에서 관리하는 것은 어렵다 CORS 문제

JWT 토큰에 대해 설명해주세요
JWP는 JSON 포맷을 이용하는 CLAIM기반의 웹 토큰이며, 토큰 자체를 정보로 사용하는
Self-Contained 방식으로 정보를 안전하게 전달한다. 
JWT는 헤더, 내용, 서명으로 구성되며 각 파트를 . 으로 구분한다. 

헤더 : 토큰의 타입과 해시 암호화 알고리즘 방식으로 이루어져 있다. 
내용 : 토큰에 사용자가 담고자 하는 정보를 담는다. 내용에는 claim이 담겨있고, 
JSON (Key/value) 형태의 한 쌍으로 이루어져있다. 

서명 : 토큰을 인코딩하거나 유효성 검증할 때 사용하는 고유한 암호화 코드이다. 
헤더와 내용의 값을 인코딩한다. 

JWT

알아보기전에 먼저 토큰 기반 인증과 서버 기반 인증에 대해 알아보자 

서버기반인증 시스템 (Session/ Cookie)
세션 기반의 인증 시스템이다. 서버 측에서 사용자들의 정보를 기억하기 위해 세션을 유지하는데
이는 메모리, 디스크 , 데이터베이스 등을 통해 관리한다. 
클라이언트로부터 요청을 받으면 클라이언트의 상태 정보를 저장하여 유지해야 하므로 
Stateful한 구조를 가진다. 

인증 방식
1. 사용자가 로그인 시 올바른 사용자임을 확인하고 고유한 세션 ID값을 부여해 세션 저장소에
2. 저장하고 클라이언트에게 발급해준다.

클라이언트는 세션 ID를 받아 쿠키에 저장하고, 인증이 필요한 요청마다 쿠키에 세션 ID
를 담아 헤더에 보낸다. 

서버에서는 쿠키를 받아 세션 저장소와 비교해 올바른 요청인지 확인한다. 
인증이 완료되고 서버는 요청에 응답한다

장점
중요한 정보는 서버에 있기 떄문에 쿠키자체에는 유의미한 값을 가지고 있지 않다. 

단점
해커가 훔친 쿠키를 이용해 HTTP 요청을 보내면 서버에서는 올바른 사용자가 보낸 요청인지
알 수 없다. 세션 하이재킹 공격

서버에 세션을 저장하므로 사용자가 증가함에 따라 과부하를 줄 수 있어
확장성이 용이하지 못하다. 
시스템 확장이 어렵다. 

토큰 기반 인증 시스템이란?
이러한 단점을 극복하기 위해 토큰 기반 인증 시스템이 나왔다. 
인증받은 사용자에게 토큰을 발급해주고 서버에 요청을 할 때 HTTP 헤더에 
토큰을 함께 보내 인증받은 사용자인지 확인한다. 
서버기반 인증시스템과 달리 사용자의 인증 정보를 서버에 저장하지 않고 클라이언트의
요청으로만 인가를 처리하므로 Stateless한 구조를 가진다. 
JWT는 JSON WEB Token의 약자로 인증에 필요한 정보를 암호화시킨 토큰을 뜻한다. 
세션/쿠키 방식과 유사하게 클라이언트는 Access TOken을 HTTP 헤더에 실어 
서버로 보낸다. 

인증 방식
1. 사용자가 로그인 시 올바른 사용자임을 확인하고, 클라이언트에게 Access Token을
2. 발급해준다. 
클라이언트는 전달받은 토큰을 저장해 두고, 인증이 필요한 요청마다 토큰을 http 헤더에 담아
3. 보낸다. 
4. 서버에서는 암호화된 토큰을 복호화 해 올바른 요청인지 확인한다. 
5. 인증이 완료되고 서버는 요청에 응답한다. 

장점 
서버 기반 인증시스템은 저장소의 관리가 필요하지만, 토큰 기반은 Access TOken을 
발급해준 후 요청이 들어오면 검증만 해주면 되기 때문에 추가 저장소가 필요 없다. 
즉 stateless하다. 

쿠키를 사용함으로 인해 발생하는 취약점이 사라지다. 하지만 토큰을 사용하는 환경에서의 취약점
대비해야한다. 

확장성이 뛰어나다. 토큰 기반으로 하는 다른 인증 시스템에 접근이 가능하다. 
facebook google등

다점
이미 발급된 JWT를 돌이길 수 없다. 서버 기반 인증 시스템처러 ㅁ저장소를 사용하느 경우에는
해당 세션이 악의적으로 사용될 경우 지워버리면 되지만 JWT는 한번 발급되면 유효기간이 완료될 때 까지는 
계속 사용이 가능하다. 
즉 유효기간이 지나기 전까지 실컷 털릴 수 있다. 
JWT의 길이가 길다. 인증이 필요한 요청이 많아질수록 서버의 자원 낭비가 발생한다. 

서버기반인증방식은 과거게 사용하던 방식이고 이를 대체하기 위하여 등장한 것이 토큰 기반 인증
방식이지만, 
토큰 기반 인증 방식을 사용한다고 해서 무조건 해킹의 위험에서 벗어난 것은 아니다. 

JWT란?
JWT란 JOSN 포맷을 이용해 사용자에 대한 속성을 지정하느 ㄴClaim 기바의 웹 토큰이다. 
JWT는 토큰 자체를 정보로 사용하는 Self-Contained방식으로 정보를 안전하게 전달한다. 

JWT는 주로 statica 변수와 로컬 스토리지에 저장한다고 한다. static 변수에 저장하는 
이유는 HTTP 통신을 할 때마다 JWT를 HTTP헤더에 담아서 보내야 하는데, 이를 
로컬 스토리지에서 계속 불러오면 오버헤드가 발생하기 떄문이다. 

JWT의 구조
JWT는 세 파트로 나누어지며, 각 파트를 점 으로 구분한다. 
각 순서대로 헤더, 페이로드, 서명 으로 구성되고, 
JSON 형태인 각 부분은 BASE64로 인코딩 되어표현된다. 

header헤더
토큰의 타입과 해시 암호화 알고리즘으로 구성된다. 









































